"use strict";(globalThis.webpackChunk_openmrs_esm_patient_orders_app=globalThis.webpackChunk_openmrs_esm_patient_orders_app||[]).push([[347],{2717:(e,r,t)=>{t.d(r,{Z:()=>s});var n=t(272),a=t.n(n),o=t(2609),l=t.n(o)()(a());l.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-orders__cancel-order-form__productiveHeading03___RXx2x,.-esm-patient-orders__cancel-order-form__title___JRPr1{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0)}.-esm-patient-orders__cancel-order-form__title___JRPr1{margin:0 .5rem .5rem 0}.-esm-patient-orders__cancel-order-form__orderDisplay___Qh6Ju{margin-bottom:1rem}.-esm-patient-orders__cancel-order-form__danger___cyWf7{color:#da1e28}.-esm-patient-orders__cancel-order-form__button___HaTwk{height:4rem;display:flex;align-content:flex-start;align-items:baseline;min-width:50%}.-esm-patient-orders__cancel-order-form__button___HaTwk .cds--inline-loading{min-height:1rem !important}.-esm-patient-orders__cancel-order-form__button___HaTwk .cds--inline-loading__text{font-size:unset !important}.-esm-patient-orders__cancel-order-form__tablet___zcFGF{padding:1.5rem 1rem;background-color:#fff}.-esm-patient-orders__cancel-order-form__desktop___TlOEb{padding:0rem}.-esm-patient-orders__cancel-order-form__form___s61QC{display:flex;flex-direction:column;justify-content:space-between;height:calc(100vh - 6rem)}.omrs-breakpoint-lt-desktop .-esm-patient-orders__cancel-order-form__form___s61QC{background-color:#ededed}.omrs-breakpoint-gt-tablet .-esm-patient-orders__cancel-order-form__form___s61QC{background-color:#fff}.-esm-patient-orders__cancel-order-form__grid___wvDgf{margin:1rem}.-esm-patient-orders__cancel-order-form__row___Wa8jp{margin:.5rem 0rem 0rem;display:flex;flex-flow:row wrap;gap:1rem}.-esm-patient-orders__cancel-order-form__spacer___ClI0I{margin-top:1rem}.-esm-patient-orders__cancel-order-form__noteInput___MfEaR{width:100%}.-esm-patient-orders__cancel-order-form__errorNotification___jz56i{margin:.5rem 0}.-esm-patient-orders__cancel-order-form__errorContainer___ss0lP{margin:1rem}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/order-cancellation-form/cancel-order-form.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CClDF,4HC61BI,kDAAA,CAAA,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CDz1BJ,uDAEE,sBAAA,CAGF,8DACE,kBEgBW,CFbb,wDACE,aDCO,CCET,wDACE,WAAA,CACA,YAAA,CACA,wBAAA,CACA,oBAAA,CACA,aAAA,CAEA,6EACE,0BAAA,CAGF,mFACE,0BAAA,CAIJ,wDACE,mBAAA,CACA,qBDvCM,CC0CR,yDACE,YAAA,CAGF,sDACE,YAAA,CACA,qBAAA,CACA,6BAAA,CACA,yBAAA,CAGF,kFACE,wBAAA,CAGF,iFACE,qBD1DM,CC6DR,sDACE,WEhCW,CFmCb,qDACE,sBAAA,CACA,YAAA,CACA,kBAAA,CACA,QEvCW,CF0Cb,wDACE,eE3CW,CF8Cb,2DACE,UAAA,CAGF,mEACE,cAAA,CAGF,gEACE,WEvDW",sourceRoot:""}]),l.locals={productiveHeading03:"-esm-patient-orders__cancel-order-form__productiveHeading03___RXx2x",title:"-esm-patient-orders__cancel-order-form__title___JRPr1",orderDisplay:"-esm-patient-orders__cancel-order-form__orderDisplay___Qh6Ju",danger:"-esm-patient-orders__cancel-order-form__danger___cyWf7",button:"-esm-patient-orders__cancel-order-form__button___HaTwk",tablet:"-esm-patient-orders__cancel-order-form__tablet___zcFGF",desktop:"-esm-patient-orders__cancel-order-form__desktop___TlOEb",form:"-esm-patient-orders__cancel-order-form__form___s61QC",grid:"-esm-patient-orders__cancel-order-form__grid___wvDgf",row:"-esm-patient-orders__cancel-order-form__row___Wa8jp",spacer:"-esm-patient-orders__cancel-order-form__spacer___ClI0I",noteInput:"-esm-patient-orders__cancel-order-form__noteInput___MfEaR",errorNotification:"-esm-patient-orders__cancel-order-form__errorNotification___jz56i",errorContainer:"-esm-patient-orders__cancel-order-form__errorContainer___ss0lP"};const s=l},2347:(e,r,t)=>{t.r(r),t.d(r,{default:()=>S});var n=t(268),a=t.n(n),o=t(3565),l=t.n(o),s=t(3955),i=t(4924),c=t(195),_=t(8883),d=t(7986),m=t(2870),A=t(2821),u=t(321),f=t.n(u),C=t(1195),p=t.n(C),g=t(3275),b=t.n(g),E=t(7162),y=t.n(E),v=t(2094),h=t.n(v),D=t(757),k=t.n(D),w=t(2717),F={};F.styleTagTransform=k(),F.setAttributes=y(),F.insert=b().bind(null,"head"),F.domAPI=p(),F.insertStyleElement=h(),f()(w.Z,F);const B=w.Z&&w.Z.locals?w.Z.locals:void 0;function T(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function x(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,a,o=[],l=!0,s=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!r||o.length!==r);l=!0);}catch(e){s=!0,a=e}finally{try{l||null==t.return||t.return()}finally{if(s)throw a}}return o}}(e,r)||function(e,r){if(e){if("string"==typeof e)return T(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?T(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const S=function(e){var r=e.order,t=e.patientUuid,o=e.closeWorkspace,u=e.promptBeforeClosing,f=(0,i.useTranslation)().t,C="tablet"===(0,m.useLayoutType)(),p=x((0,n.useState)(!1),2),g=p[0],b=p[1],E=x((0,n.useState)(!1),2),y=E[0],v=E[1],h=(0,A.usePatientOrders)(t).mutate,D=(0,n.useMemo)((function(){return c.z.object({cancellationDate:c.z.date({required_error:f("cancellationDateRequired","Cancellation date is required")}).refine((function(e){return e>=l()().startOf("day").toDate()}),{message:f("dateCannotBeBeforeToday","Date cannot be before today")}),reasonForCancellation:c.z.string({required_error:f("reasonForCancellationRequired","Reason for cancellation is required")})})}),[]),k=(0,s.cI)({mode:"all",resolver:(0,_.F)(D)}),w=k.control,F=k.handleSubmit,T=k.formState,S=T.errors,N=T.isDirty;(0,n.useEffect)((function(){u((function(){return N}))}),[N]);var R=(0,n.useCallback)((function(e){var t=e;v(!1),b(!0);var n={fulfillerStatus:"DECLINED",fulfillerComment:t.reasonForCancellation};(function(e,r){var t=(0,m.useAbortController)();return(0,m.openmrsFetch)("".concat(m.restBaseUrl,"/order/").concat(e.uuid,"/fulfillerdetails/"),{method:"POST",headers:{"Content-Type":"application/json"},body:r,signal:t.signal})})(r,n).then((function(e){b(!1),o(),h(),(0,m.showSnackbar)({title:f("orderCancelled","Order cancelled"),kind:"success",subtitle:f("successfullyCancelledOrder","Order {{orderNumber}} has been cancelled successfully",{orderNumber:null==r?void 0:r.orderNumber})})}),(function(e){b(!1),(0,m.showSnackbar)({isLowContrast:!0,title:f("errorCancellingOrder","Error cancelling order"),kind:"error",subtitle:null==e?void 0:e.message})}))}),[]);return a().createElement(d.l09,{className:B.form},a().createElement("div",{className:B.grid},a().createElement(d.Kqy,null,a().createElement("section",null,a().createElement("h4",{className:B.orderDisplay},null==r?void 0:r.display)),a().createElement("section",null,a().createElement(s.Qr,{name:"cancellationDate",control:w,render:function(e){var r=e.field,t=r.onChange,n=r.value;return a().createElement("div",{className:B.row},a().createElement(d.Mtg,{id:"cancellationDate",minDate:l()().startOf("day"),dateFormat:"d/m/Y",datePickerType:"single",value:n,onChange:function(e){var r=x(e,1)[0];return t(r)},autocomplete:"off"},a().createElement(d.aj6,{id:"date-picker-calendar-id",placeholder:"dd/mm/yyyy",labelText:f("cancellationDate","Cancellation date"),type:"text",invalid:!!S.cancellationDate,invalidText:!!S.cancellationDate&&S.cancellationDate.message})))}})),a().createElement("section",null,a().createElement(s.Qr,{name:"reasonForCancellation",control:w,render:function(e){var r=e.field,t=r.onChange,n=r.value;return a().createElement("div",{className:B.row},a().createElement(d.Kx8,{type:"text",id:"reasonForCancellation",labelText:f("reasonForCancellation","Reason for cancellation"),value:n,onChange:function(e){return t(e.target.value)},invalid:!!S.reasonForCancellation,invalidText:!!S.reasonForCancellation&&S.reasonForCancellation.message}))}})))),y&&a().createElement(d.sgG,{className:B.errorContainer},a().createElement(d.K0D,{lowContrast:!0,title:f("error","Error"),subtitle:f("pleaseFillRequiredFields","Please fill all the required fields")+".",onClose:function(){return v(!1)}})),a().createElement(d.uVA,{className:C?B.tablet:B.desktop},a().createElement(d.zxk,{className:B.button,kind:"secondary",onClick:o},f("discard","Discard")),a().createElement(d.zxk,{className:B.button,kind:"primary",onClick:F(R,(function(e){(null==e?void 0:e.oneFieldRequired)&&v(!0)})),disabled:g,type:"submit"},g?a().createElement(d.lSo,{description:f("saving","Saving")+"..."}):f("saveAndClose","Save and close"))))}}}]);